(self.webpackChunkchendachao=self.webpackChunkchendachao||[]).push([[203],{21203:function(S,g,r){"use strict";r.r(g);var w=r(92592),L=r(90908);r.e(284).then(r.bind(r,57284));function E(){var u="appear-from-top",f="disappear-from-top",C=/localhost|127.0.0.1/,l=C.test(window.location.origin)?"https://chendachao.github.io":window.location.origin,t=document.querySelector("#dialog"),p=document.querySelectorAll(".dialog-dismiss-trigger"),s=document.querySelector(".download-btn"),y=document.querySelector(".qrcode-handler"),c=document.querySelector(".mobile-qrcode");c.setAttribute("alt",l),L.Z.registerDialog(t),y.addEventListener("click",function(){t.showModal(),t.classList.add(u),setTimeout(function(){t.classList.remove(u)},650);var e=document.createElement("canvas"),d={width:320,height:320,margin:3};w.toCanvas(e,l,{width:d.width,height:d.height,margin:d.margin,errorCorrectionLevel:"H",quality:1,version:5,color:{}}).then(function(i){var o={width:48,height:48},R="/assets/images/icons/favicon.ico",a=i.getContext("2d"),h=new Image;h.src=R,h.onload=function(){var n=6;a.lineWidth=n/3,a.lineJoin="round",a.lineCap="round",a.strokeStyle="#ffffff",a.beginPath(),a.rect(i.width/2-o.width/2-n/4,i.width/2-o.width/2-n/4,o.width+n,o.height+n),a.stroke(),a.fillStyle="#ffffff",a.fillRect(i.width/2-o.width/2-n/4,i.height/2-o.height/2-n/4,o.width+n,o.height+n),a.drawImage(h,i.width/2-o.width/2+n/4,i.height/2-o.height/2+n/4,o.width,o.height),c.src=i.toDataURL("image/png")}}).catch(function(i){c.setAttribute("alt","Failed to generate QRCode, please visit ".concat(l)),console.error(i)})});function m(){t.classList.add("shake"),setTimeout(function(){return t.classList.remove("shake")},300)}function v(e){t.classList.add(f),setTimeout(function(){t.classList.remove(f),t.close(e)},500)}function D(e){s.download="".concat(window.location.hostname,".png"),s.href=e}p.forEach(function(e){e.addEventListener("click",function(){v()})}),s.addEventListener("click",function(){v(),D(c.src)}),t.addEventListener("close",function(){t.returnValue=""}),t.addEventListener("click",function(e){var d=t.getBoundingClientRect(),i=d.top<=e.clientY&&e.clientY<=d.bottom&&d.left<=e.clientX&&e.clientX<=d.right;i||m()}),t.addEventListener("cancel",function(e){e.preventDefault(),m()})}g.default=E}}]);
